# 相册管理系统数据库设计

这是一个简单的相册管理系统的数据库脚本集合，包含数据库创建、表结构定义、触发器和备份功能。

## 文件说明

### 1. create.sql
数据库创建脚本
- 创建SimpleAlbumDB数据库
- 设置字符集为utf8，排序规则为utf8_general_ci

### 2. createTable.sql
数据库表结构定义
- `User`表：存储用户信息，包括用户名、密码、存储容量等
- `Resource`表：存储资源信息（相册、照片、分享链接）
- 使用复合分区策略对资源表进行分区（按资源类型和创建时间）

### 3. createTrigger.sql
触发器脚本
- `TR_Photo_Storage`：在上传照片前检查并扣减用户存储容量
- `TR_Photo_DelStorage`：在删除照片后归还存储容量给用户
- 两个触发器都维护相册中的照片数量统计

### 4. coreFindUpdate.sql
核心查询和操作示例脚本
- 包含用户登录验证查询
- 创建相册、上传照片的操作示例
- 查询用户相册和相册内照片的功能
- 生成分享链接和按标签检索照片的功能

### 5. backup.sql
数据库备份脚本
- 创建了一个每日执行的定时事件 `EV_Album_Backup`
- 每天凌晨1点自动备份SimpleAlbumDB数据库
- 备份文件以日期命名（格式：SimpleAlbumDB_YYYYMMDD.sql）
- 自动删除15天前的旧备份文件

## 系统功能

整个系统设计为一个简单的相册管理系统，支持：
- 用户管理（注册、登录）
- 相册创建和管理
- 照片上传和存储（带容量限制）
- 照片分享功能
- 按标签检索照片
- 自动备份功能